---
import { Icon } from "astro-icon/components";
import Brands from "./Brands.astro";

export interface Testimonial {
  name: string;
  role: string;
  image: string;
  quote: string;
}

export interface Props {
  testimonials?: Testimonial[];
}

const {
  testimonials = [
    {
      name: 'Richard Malone',
      role: 'Project Director, Skyline Infrastructure',
      image: '/img/male1.jpg',
      quote: 'Their team delivered our commercial building ahead of schedule with exceptional workmanship. Truly reliable and highly professional.'
    },
    {
      name: 'Emily Carter',
      role: 'Facility Manager, GreenLeaf Manufacturing',
      image: '/img/female1.jpg',
      quote: 'From planning to execution, every step was handled with precision. The quality of their construction far exceeded our expectations.'
    },
    {
      name: 'Christopher Hayes',
      role: 'Senior Engineer, UrbanBuild Consultants',
      image: '/img/male2.jpg',
      quote: 'A trustworthy partner for large-scale projects. Their attention to safety, detail, and engineering standards is outstanding.'
    },
    {
      name: 'Samantha Rivera',
      role: 'Real Estate Developer, Rivera Properties',
      image: '/img/female2.jpg',
      quote: 'They transformed our development vision into reality with remarkable efficiency and craftsmanship. Highly recommended for any construction project.'
    },
    {
      name: 'Daniel Brooks',
      role: 'Operations Manager, NorthBridge Logistics',
      image: '/img/male3.jpg',
      quote: 'Professional, organized, and transparent throughout the entire project. The end result was durable, high-quality, and built to last.'
    }
  ]
} = Astro.props;
---

<section class="py-20 bg-bg-soft overflow-hidden">
  <div class="max-w-7xl mx-auto px-4">
    <div class="text-center mb-16">
      <div class="inline-block px-4 py-2 bg-primary-soft text-primary-dark rounded-full font-semibold mb-4">
        CLIENT TESTIMONIALS
      </div>
      <h2 class="font-display text-4xl md:text-5xl text-dark mb-4">WHAT THEY SAY</h2>
    </div>

    <div class="max-lg:flex max-lg:flex-col lg:grid lg:grid-cols-2 gap-12">
        <div
        x-data=`{
            currentSlide: 0,
            
            nextSlide() {
            this.currentSlide = (this.currentSlide + 1) % ${testimonials.length};
            },
            
            prevSlide() {
            this.currentSlide = (this.currentSlide - 1 + ${testimonials.length}) % ${testimonials.length};
            }
        }`
        class="relative group"
        >
        <!-- Testimonial Cards -->
        <div class="w-full overflow-hidden">
            <div 
            class="flex transition-transform duration-500 ease-in-out"
            x-bind:style="`transform: translateX(-${currentSlide * 100}%)`"
            >
            {testimonials.map((testimonial, index) => (
                <div class="w-full shrink-0 px-4">
                <div class="bg-white rounded-xl shadow-lg p-8 md:p-12 mb-3">
                    <div class="flex gap-2 text-accent-yellow mb-4">
                    <Icon name="bi:star-fill" class="w-5 h-5" />
                    <Icon name="bi:star-fill" class="w-5 h-5" />
                    <Icon name="bi:star-fill" class="w-5 h-5" />
                    <Icon name="bi:star-fill" class="w-5 h-5" />
                    <Icon name="bi:star-fill" class="w-5 h-5" />
                    </div>

                    <p class="text-steel-gray italic mb-6 text-lg">
                    "{testimonial.quote}"
                    </p>

                    <div class="flex items-center gap-4">
                    <img 
                        src={testimonial.image} 
                        alt={testimonial.name}
                        class="w-14 h-14 rounded-full object-cover"
                    />
                    <div>
                        <h3 class="font-bold text-dark">{testimonial.name}</h3>
                        <p class="text-sm text-steel-gray">{testimonial.role}</p>
                    </div>
                    </div>
                </div>
                </div>
            ))}
            </div>
        </div>

        <!-- Navigation Buttons -->
        <button
            type="button"
            aria-label="Previous testimonial"
            x-on:click="prevSlide()"
            class="opacity-100 md:opacity-0 md:group-hover:opacity-100 duration-500 absolute left-0 top-1/2 -translate-y-1/2 -translate-x-4 bg-primary text-white w-12 h-12 rounded-full flex items-center justify-center hover:bg-opacity-80 transition-all shadow-lg"
        >
            <Icon name="bi:chevron-left" class="w-6 h-6" />
        </button>

        <button
            type="button"
            aria-label="Next testimonial"
            x-on:click="nextSlide()"
            class="opacity-100 md:opacity-0 md:group-hover:opacity-100 duration-500 absolute right-0 top-1/2 -translate-y-1/2 translate-x-4 bg-primary text-white w-12 h-12 rounded-full flex items-center justify-center hover:bg-opacity-80 transition-all shadow-lg"
        >
            <Icon name="bi:chevron-right" class="w-6 h-6" />
        </button>

        <!-- Dots Indicator -->
        <div class="flex justify-center mt-4 gap-2">
            {testimonials.map((_, index) => (
            <button
                type="button"
                aria-label={`Go to testimonial ${index + 1}`}
                x-on:click={`currentSlide = ${index}`}
                class="h-2 rounded-full transition-all duration-300"
                x-bind:class={`currentSlide === ${index} ? 'bg-primary w-8' : 'bg-dark/30 w-2'`}
            />
            ))}
        </div>
        </div>
        <Brands />
    </div>
  </div>
</section>